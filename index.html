<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./bundle/arcade-physics.min.js"></script>
  </head>
  <body>
    <style>
      html {
        background: #2c3349;
      }
      body {
        font-family: Arial, Helvetica, sans-serif;
        color: #f8f8f2;
      }
      h1 {
        text-align: center;
      }
      #wrapper {
        width: 100%;
      }
      canvas {
        margin: 0 auto;
        max-width: 100%;
        display: block;
        background: #0c0e14;
      }
    </style>

    <h1>Arcade Physics<br /><small>(without Phaser)</small></h1>
    <div style="margin-bottom: 8px; text-align: center">
      <a style="text-decoration: none" href="https://github.com/yandeu/arcade-physics/actions/workflows/main.yml">
        <img src="https://github.com/yandeu/arcade-physics/actions/workflows/main.yml/badge.svg" alt="CI" />
      </a>
      <a style="text-decoration: none" href="https://github.com/yandeu/arcade-physics/tree/gh-pages/bundle">
        <img src="https://badgen.net/badgesize/gzip/yandeu/arcade-physics/gh-pages/bundle/main.js" alt="gzip size" />
      </a>
      <a style="text-decoration: none" href="https://codecov.io/gh/yandeu/arcade-physics">
        <img
          src="https://codecov.io/gh/yandeu/arcade-physics/branch/main/graph/badge.svg?token=7LZVKzgHUT"
          alt="codecov"
        />
      </a>
    </div>

    <div id="wrapper">
      <canvas id="myCanvas" width="800" height="450" style="border: 1px solid #000000"> </canvas>
    </div>

    <script>
      const { ArcadePhysics } = PHYSICS

      var canvas = document.getElementById('myCanvas')
      var ctx = canvas.getContext('2d')

      const config = {
        sys: {
          game: {
            config: {}
          },
          settings: {
            physics: {
              debug: true,
              gravity: {
                x: 0,
                y: 300
              }
            }
          },
          scale: {
            width: 800,
            height: 450
          },
          queueDepthSort: () => {}
        }
      }

      // physics
      const physics = new ArcadePhysics(config)

      // player
      const player = physics.add.body(20, 20, 64, 64)
      player.setVelocityX(20)
      player.setBounce(0.6)
      player.setCollideWorldBounds(true)

      // ball
      const ball = physics.add.body(206, 20)
      ball.setCircle(32)
      ball.setBounce(0.8)
      ball.setCollideWorldBounds(true)

      // platform
      const platform = physics.add.staticBody(60, 350, 160, 32)

      // colliders
      physics.add.collider(player, ball)
      physics.add.collider(player, platform)
      physics.add.collider(ball, platform)

      let tick = 0
      const update = () => {
        physics.world.update(tick * 1000, 1000 / 60)
        tick++

        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)

        // draw debug
        physics.world.bodies.forEach(b => {
          b.drawDebug(ctx)
        })
        physics.world.staticBodies.forEach(b => {
          b.drawDebug(ctx)
        })

        requestAnimationFrame(update)
      }

      requestAnimationFrame(update)
    </script>
  </body>
</html>
